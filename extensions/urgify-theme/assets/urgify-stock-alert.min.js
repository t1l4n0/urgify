(()=>{const t=document.querySelectorAll('[id^="urgify-stock-alert-"]'),e=document.getElementById("urgify-stock-alert-auto"),n=[...t];e&&n.push(e),n.forEach(t=>{if(!t)return;const e=t.id.includes("auto")?"auto":t.id.split("-").pop(),n=window.__urgifyConfig||{},o=parseInt(n.global_threshold||t.dataset.threshold,10)||5,i=n.low_stock_message||t.dataset.message||t.dataset.lowMessage||"Only {{qty}} left in stock!",a=n.font_size||t.dataset.fontSize||null,s=n.text_color||t.dataset.textColor||null,r=n.background_color||t.dataset.backgroundColor||null,d=n.stock_counter_animation||t.dataset.animation||"pulse",l=n.stock_alert_style||t.dataset.style||"spectacular",c=t.dataset.shake||"disabled",u="true"===t.dataset.tracksInventory;n.stock_counter_position&&"urgify-stock-alert-auto"===t.id&&(t.dataset.position=n.stock_counter_position);let y={};try{const t=document.getElementById(`urgify-variant-qty-${e}`)?.textContent||document.getElementById("urgify-variant-qty-auto")?.textContent||"{}";y=JSON.parse(t)}catch(t){console.warn("Urgify: Could not parse variant quantities",t),y={}}const f=t.querySelector(".urgify-stock-alert__text");function p(){const t=document.querySelector('form[action*="/cart"] [name="id"], [name="id"]');if(t&&t.value)return t.value;const e=document.querySelector("[data-selected-variant-id]");if(e?.getAttribute("data-selected-variant-id"))return e.getAttribute("data-selected-variant-id");const n=document.querySelector('input[name="id"]:checked');return n?n.value:null}function g(){!function(){if(!t||"urgify-stock-alert-auto"!==t.id||"true"===t.dataset.positionApplied)return;const e=document.querySelector('form[action*="/cart"] [type="submit"], form[action*="/cart"] button[name="add"]');if(e&&e.closest("form")){const n=e.closest("form");"custom"===t.dataset.position&&(t.dataset.position="above"),"below"===t.dataset.position?n.parentNode.insertBefore(t,n.nextSibling):n.parentNode.insertBefore(t,n),t.dataset.positionApplied="true"}}();const e=p();if(!e)return setTimeout(g,250),t.hidden=!0,void(t.style.display="none");const n=y[e];return u?"number"!=typeof n||n<=0?(t.hidden=!0,void(t.style.display="none")):void(n<=o?(f.innerHTML=i.replace(/\{\{qty\}\}/g,n),t.classList.remove("urgify-stock-alert--critical"),"custom"===l&&(a&&t.style.setProperty("--urgify-font-size",a),s&&(t.style.setProperty("--urgify-text-color",s),t.style.setProperty("--urgify-border",s)),r&&(t.style.setProperty("--urgify-bg",r),t.style.background=r,t.style.backgroundImage="none",t.style.setProperty("background-color",r,"important"))),"none"===d&&t.style.setProperty("--urgify-animation","none"),"pulse"===d&&t.style.setProperty("--urgify-animation","scarcityPulse 2s infinite"),"bounce"===d&&t.style.setProperty("--urgify-animation","urgifyBounce 1.2s infinite"),"shake"===d&&t.style.setProperty("--urgify-animation","criticalShake 0.5s infinite"),"enabled"===c&&t.style.setProperty("--urgify-animation-critical","criticalShake 0.5s infinite"),t.hidden=!1,t.style.display="flex"):(t.hidden=!0,t.style.display="none",t.style.visibility="hidden",t.style.opacity="0",t.style.height="0",t.style.overflow="hidden",t.style.margin="0",t.style.padding="0")):(t.hidden=!0,void(t.style.display="none"))}document.addEventListener("variant:change",g,{passive:!0}),document.addEventListener("change",t=>{"id"===t.target?.name&&g()},{passive:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g,{once:!0}):g();const m=new MutationObserver(()=>{p()&&(g(),m.disconnect())});m.observe(document.documentElement,{childList:!0,subtree:!0})})})();