{% comment %}
  Urgify App Embed block. This creates a proper Theme App Embed entry
  that merchants can enable in the Theme Editor. It loads the core snippet
  and auto-injects the stock alert when enabled in the admin app.
{% endcomment %}

{% render 'core' %}

<!-- Self-reporting: Ping the app when embed is loaded (no CORS issues) -->
<script>
  // Track embed activation asynchronously
  if (typeof fetch !== 'undefined') {
    fetch('https://urgify.fly.dev/api/embed-activated?shop={{ shop.permanent_domain | url_encode }}&theme_id={{ theme.id }}&t={{ 'now' | date: '%s' }}', {
      method: 'GET',
      mode: 'no-cors'
    }).catch(() => {}); // Ignore errors
  }
</script>

{% schema %}
{
  "name": "Urgify",
  "target": "body",
  "enabled_on": {
    "templates": ["product"]
  },
  "settings": [
    {
      "type": "paragraph",
      "content": "The Urgify app embedding activates all Urgify functions in your shop. It enables you to display countdown timers, limited offers, scarcity banners, and stock alerts on your product pages."
    }
  ]
}
{% endschema %}


